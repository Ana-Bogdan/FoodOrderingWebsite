<% content_for :title, "Eureka Caffe - Order ##{@order.id}" %>

<% content_for :hero_content do %>
  <%= render 'shared/hero', title: "Order ##{@order.id}", description: "Order details and status" %>
<% end %>

<div class="order-detail-container">
  <div class="order-summary">
    <div class="order-header">
      <div class="order-info">
        <h2>Order #<%= @order.id %></h2>
        <div class="order-meta">
          <p><strong>Order Date:</strong> <%= @order.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
          <p><strong>Status:</strong> 
            <span class="order-status <%= @order.status %>">
              <%= @order.status.capitalize %>
            </span>
          </p>
          <p><strong>Total Items:</strong> <%= @order.item_count %></p>
        </div>
      </div>
      <div class="order-actions">
        <%= link_to "← Back to My Orders", my_orders_path, class: "btn btn-secondary" %>
      </div>
    </div>
  </div>

  <div class="order-items-detail">
    <h3>Order Items</h3>
    <div class="items-list">
      <% @order.order_items.each do |order_item| %>
        <div class="order-item-detail">
          <div class="product-image">
            <img src="<%= order_item.product.image %>" alt="<%= order_item.product.name %>">
          </div>
          <div class="product-info">
            <h4><%= order_item.product.name %></h4>
            <p class="product-category"><%= order_item.product.category %></p>
            <div class="product-details">
              <span class="price">$<%= number_with_precision(order_item.price_at_time, precision: 2) %></span>
              <span class="quantity">× <%= order_item.quantity %></span>
              <span class="subtotal">$<%= number_with_precision(order_item.price_at_time * order_item.quantity, precision: 2) %></span>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <div class="order-total-section">
    <div class="total-card">
      <h3>Order Summary</h3>
      <div class="total-breakdown">
        <div class="total-row">
          <span>Subtotal:</span>
          <span>$<%= number_with_precision(@order.total_amount, precision: 2) %></span>
        </div>
        <div class="total-row total-final">
          <span><strong>Total:</strong></span>
          <span><strong>$<%= number_with_precision(@order.total_amount, precision: 2) %></strong></span>
        </div>
      </div>
    </div>
  </div>

  <div class="order-actions-bottom">
    <%= link_to "Place New Order", root_path, class: "btn btn-primary" %>
    <%= link_to "View All Orders", my_orders_path, class: "btn btn-secondary" %>
  </div>
</div>
