<% content_for :title, "Eureka Caffe - Admin Orders" %>

<% content_for :hero_content do %>
  <h1>Admin Orders Dashboard</h1>
  <div class="hero-divider">
    <svg class="squiggle" width="600" height="28" viewBox="0 0 600 28" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 14 Q 8 0, 16 14 T 32 14 T 48 14 T 64 14 T 80 14 T 96 14 T 112 14 T 128 14 T 144 14 T 160 14 T 176 14 T 192 14 T 208 14 T 224 14 T 240 14 T 256 14 T 272 14 T 288 14 T 304 14 T 320 14 T 336 14 T 352 14 T 368 14 T 384 14 T 400 14 T 416 14 T 432 14 T 448 14 T 464 14 T 480 14 T 496 14 T 512 14 T 528 14 T 544 14 T 560 14 T 576 14 T 592 14 T 600 14" stroke="white" stroke-width="2" fill="none"/>
    </svg>
    <span class="cutlery-icon">
      <img src="https://png.pngtree.com/png-clipart/20231115/ourmid/pngtree-fork-and-knife-png-image_10593218.png" alt="Cutlery" />
    </span>
    <svg class="squiggle" width="600" height="28" viewBox="0 0 600 28" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 14 Q 8 0, 16 14 T 32 14 T 48 14 T 64 14 T 80 14 T 96 14 T 112 14 T 128 14 T 144 14 T 160 14 T 176 14 T 192 14 T 208 14 T 224 14 T 240 14 T 256 14 T 272 14 T 288 14 T 304 14 T 320 14 T 336 14 T 352 14 T 368 14 T 384 14 T 400 14 T 416 14 T 432 14 T 448 14 T 464 14 T 480 14 T 496 14 T 512 14 T 528 14 T 544 14 T 560 14 T 576 14 T 592 14 T 600 14" stroke="white" stroke-width="2" fill="none"/>
    </svg>
  </div>
  <p>Manage and track all customer orders.</p>
<% end %>

<div class="orders-container">
  <% if @orders.any? %>
    <div class="orders-list">
      <% @orders.each do |order| %>
        <div class="order-item <%= 'completed' if order.completed? %>">
          <div class="order-header">
            <div class="order-info">
              <h3>Order #<%= order.id %></h3>
              <div class="order-meta">
                <span class="customer-info">
                  <strong><%= order.user.name %></strong> (<%= order.user.email %>)
                </span>
                <span class="order-date">
                  <%= order.created_at.strftime("%B %d, %Y at %I:%M %p") %>
                </span>
                <span class="order-status <%= order.status %>">
                  <%= order.status.capitalize %>
                </span>
              </div>
            </div>
            <div class="order-actions">
              <% if order.completed? %>
                <%= button_to toggle_order_status_path(order), method: :patch, class: "btn btn-success status-btn", title: "Mark as pending" do %>
                  <i class="fas fa-check"></i> Completed
                <% end %>
              <% else %>
                <%= button_to toggle_order_status_path(order), method: :patch, class: "btn btn-warning status-btn", title: "Mark as completed" do %>
                  Complete
                <% end %>
              <% end %>
            </div>
          </div>
          
          <div class="order-items">
            <% order.order_items.each do |order_item| %>
              <div class="order-product">
                <div class="product-image">
                  <img src="<%= order_item.product.image %>" alt="<%= order_item.product.name %>">
                </div>
                <div class="product-details">
                  <h4><%= order_item.product.name %></h4>
                  <p class="product-price">$<%= number_with_precision(order_item.price_at_time, precision: 2) %> each</p>
                  <p class="product-quantity">Quantity: <%= order_item.quantity %></p>
                  <p class="product-subtotal">Subtotal: $<%= number_with_precision(order_item.price_at_time * order_item.quantity, precision: 2) %></p>
                </div>
              </div>
            <% end %>
          </div>
          
          <div class="order-footer">
            <div class="order-total">
              <h4>Total: $<%= number_with_precision(order.total_amount, precision: 2) %></h4>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div class="empty-orders">
      <h2>No orders found</h2>
      <p>Orders will appear here once customers place them.</p>
    </div>
  <% end %>
</div> 
